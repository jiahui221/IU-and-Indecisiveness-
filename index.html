<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Research Study: Intolerance of Uncertainty & Behavioural Indecisiveness</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .container {
            max-width: 800px;
            width: 100%;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 18px;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .header p {
            font-size: 26px;
            opacity: 1;
            line-height: 1.5;
            font-weight: 700;
        }

        .progress-bar {
            height: 6px;
            background: #e0e0e0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s ease;
            width: 0%;
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
            animation: fadeIn 0.5s ease;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 22px;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 5px;
        }

        .info-box h3 {
            color: #667eea;
            margin-bottom: 10px;
            font-size: 16px;
        }

        .info-box p, .info-box ul {
            color: #555;
            font-size: 14px;
            line-height: 1.6;
            margin-bottom: 10px;
        }

        .info-box ul {
            margin-left: 20px;
        }

        .contact-info {
            background: #fff3cd;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ffc107;
        }

        .contact-info h4 {
            color: #856404;
            margin-bottom: 5px;
            font-size: 14px;
        }

        .contact-info p {
            color: #856404;
            font-size: 13px;
            margin: 3px 0;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            color: #333;
            font-weight: 500;
            margin-bottom: 8px;
            font-size: 15px;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            transition: border-color 0.3s ease;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .radio-option:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            width: 20px;
            height: 20px;
            cursor: pointer;
        }

        .radio-option.selected {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .likert-scale {
            display: flex;
            justify-content: space-between;
            gap: 10px;
            margin-top: 15px;
        }

        .likert-option {
            flex: 1;
            text-align: center;
        }

        .likert-option input[type="radio"] {
            display: none;
        }

        .likert-option label {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 12px 8px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            min-height: 90px;
        }

        .likert-number {
            font-size: 24px;
            font-weight: 700;
            color: #667eea;
            margin-bottom: 8px;
            display: block;
        }

        .likert-label {
            font-size: 11px;
            font-weight: 400;
            line-height: 1.3;
            color: #666;
            display: block;
        }

        .likert-option input[type="radio"]:checked + label {
            background: #667eea;
            border-color: #667eea;
        }

        .likert-option input[type="radio"]:checked + label .likert-number {
            color: white;
        }

        .likert-option input[type="radio"]:checked + label .likert-label {
            color: white;
        }

        .likert-option label:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }

        .buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
            gap: 15px;
        }

        button {
            padding: 14px 30px;
            border: none;
            border-radius: 8px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            flex: 1;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f8f9fa;
            color: #333;
            border: 2px solid #e0e0e0;
        }

        .btn-secondary:hover {
            background: #e9ecef;
        }

        .btn-submit {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            width: 100%;
        }

        .btn-submit:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(17, 153, 142, 0.4);
        }

        .btn-decision {
            padding: 16px 40px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            color: white;
            flex: 1;
            max-width: 350px;
        }

        .btn-orange {
            background: #F97316;
        }

        .btn-orange:hover {
            background: #EA580C;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(249, 115, 22, 0.4);
        }

        .btn-blue {
            background: #3B82F6;
        }

        .btn-blue:hover {
            background: #2563EB;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(59, 130, 246, 0.4);
        }

        .btn-decision:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .ius-question {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .ius-question p {
            font-size: 15px;
            color: #333;
            margin-bottom: 15px;
            font-weight: 500;
        }

        .thank-you {
            text-align: center;
            padding: 40px 20px;
        }

        .thank-you h2 {
            color: #667eea;
            font-size: 28px;
            margin-bottom: 20px;
        }

        .thank-you .emoji {
            font-size: 60px;
            margin: 20px 0;
        }

        .thank-you p {
            color: #555;
            line-height: 1.8;
            margin-bottom: 15px;
        }

        .task-container {
            background: #f8f9fa;
            padding: 30px;
            border-radius: 10px;
            text-align: center;
        }

        .color-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 8px;
            margin: 30px 0;
            max-width: 350px;
            margin-left: auto;
            margin-right: auto;
        }

        .color-box {
            aspect-ratio: 1;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 3px solid transparent;
        }

        .color-box:hover {
            transform: scale(1.1);
            border-color: #333;
        }

        .color-box.revealed {
            opacity: 1;
        }

        .color-box.hidden {
            background: #d0d0d0 !important;
        }

        .task-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin-top: 20px;
        }

        .task-info {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .task-info p {
            margin: 10px 0;
            color: #555;
        }

        .task-info strong {
            color: #667eea;
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            .header h1 {
                font-size: 16px;
            }

            .header p {
                font-size: 20px;
            }

            .likert-option label {
                font-size: 14px;
                padding: 12px 8px;
            }

            .color-grid {
                grid-template-columns: repeat(5, 1fr);
                max-width: 300px;
                gap: 6px;
            }
        }

        .error {
            color: #dc3545;
            font-size: 13px;
            margin-top: 5px;
            display: none;
        }

        .required {
            color: #dc3545;
        }

        #loadingOverlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  background: rgba(255,255,255,0.75);
  backdrop-filter: blur(5px);
  display: none !important;  /* important to prevent override */
  justify-content: center;
  align-items: center;
  z-index: 99999;
}

.loader-box {
    width: 300px;
    text-align: center;
}

.loader-text {
    font-size: 18px;
    margin-bottom: 15px;
    color: #333;
    font-weight: 600;
}

.loader-bar {
    width: 100%;
    height: 10px;
    background: #e0e0e0;
    border-radius: 20px;
    overflow: hidden;
}

.loader-fill {
    height: 100%;
    width: 0%;
    background: linear-gradient(90deg,#667eea,#764ba2);
    animation: loadingAnim 2s infinite;
}

@keyframes loadingAnim {
    0% { width: 0%; }
    50% { width: 80%; }
    100% { width: 0%; }
}

    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Research Study</h1>
            <p>The Relationship between Intolerance of Uncertainty and Behavioural Indecisiveness among Emerging Adults</p>
        </div>
        
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill"></div>
        </div>

        <div class="content">
            <!-- Section 1: Informed Consent -->
            <div class="section active" id="section1">
                <h2>Informed Consent Form</h2>
                <p>Dear participants,</p>
                <p style="margin: 15px 0; line-height: 1.6;">You are invited to participate in a research study exploring <strong>The Relationship between Intolerance of Uncertainty and Behavioural Indecisiveness Among Emerging Adults</strong>. Please read the information below carefully to understand the study's purpose, what your participation involves, and your rights as a participant.</p>

                <div class="info-box">
                    <h3>Description of the study:</h3>
                    <p>This study aims to examine the relationship between intolerance of uncertainty and behavioural indecisiveness among emerging adults. Participants will complete a set of validated self-report questionnaires assessing intolerance of uncertainty, and a computerized Information Sampling Task (IST), which includes both the Fixed-Win (FW) and Decreasing-Win (DW) conditions, to measure behavioural indecisiveness. This study contributes by providing empirical evidence on the relationship between intolerance of uncertainty and behavioural indecisiveness among emerging adults.</p>
                </div>

                <div class="info-box">
                    <h3>To take part in this study, you must:</h3>
                    <ul>
                        <li>Be aged between 18-25 years old</li>
                        <li>Have a normal color vision</li>
                        <li>Not have been diagnosed with psychological disorders such as Generalized Anxiety Disorder and Obsessive-Compulsive Disorder</li>
                    </ul>
                </div>

                <div class="info-box">
                    <h3>What will be done:</h3>
                    <p>In this form, you will be asked to complete:</p>
                    <ul>
                        <li>A demographic questionnaire</li>
                        <li>The Intolerance of Uncertainty Scale (IU-12, 12 items)</li>
                        <li>The Information Sampling Task</li>
                    </ul>
                    <p>This entire study will take no longer than 30 minutes to complete.</p>
                </div>

                <div class="info-box">
                    <h3>Risks and discomfort:</h3>
                    <p>No major risks are anticipated in this study. However, if you experience any discomfort during the study, you are free to close the Survey Form without submitting your responses and will not be held responsible. If you experience any discomfort, you may contact one of the following or any reputable counselling centre near you. Please note that CPCS only sees clients by appointment.</p>
                </div>

                <div class="contact-info">
                    <h4>Centre of Psychological and Counselling Services (CPCS)</h4>
                    <p>üåê Website: <a href="https://www.cpcs-helpuni.com/" target="_blank" style="color: #856404; text-decoration: underline;">https://www.cpcs-helpuni.com/</a></p>
                    <p>üìû Phone: +603 2096 1212 / +603 7849 3200</p>
                    <p>üìß Email: <a href="mailto:cpcs@help.edu.my" style="color: #856404; text-decoration: underline;">cpcs@help.edu.my</a></p>
                </div>

                <div class="contact-info">
                    <h4>Befrienders KL</h4>
                    <p>üåê Website: <a href="https://www.befrienders.org.my/" target="_blank" style="color: #856404; text-decoration: underline;">https://www.befrienders.org.my/</a></p>
                    <p>üìû Phone: +603 7627 2929</p>
                    <p>üìß Email: <a href="mailto:sam@befrienders.org.my" style="color: #856404; text-decoration: underline;">sam@befrienders.org.my</a></p>
                </div>

                <div class="info-box">
                    <h3>Benefits of this study</h3>
                    <p>There will not be any direct benefit to you in participating in this study, but you will help the researcher to learn more about the relationship between intolerance of uncertainty and behavioural indecisiveness among emerging adults in Malaysia.</p>
                </div>

                <div class="info-box">
                    <h3>Confidentiality:</h3>
                    <p>Your participation in this study will remain completely confidential. No identifying information will be collected and your responses will be recorded anonymously. Only the research team and their academic supervisor will have access to the data, which will be used solely for research purposes. Every effort will be made to ensure your privacy is protected throughout the study.</p>
                </div>

                <div class="info-box">
                    <h3>Decision to quit at anytime:</h3>
                    <p>Participation in this study is completely voluntary. If you choose to participate, you can withdraw at any time by simply exiting the Survey Form without submitting it. There will be no consequences for choosing to withdraw from the study.</p>
                </div>

                <div class="info-box">
                    <h3>Rights and complaints:</h3>
                    <p>This study has been reviewed and approved by the Ethics Review Board, Department of Psychology, Faculty of Behavioral Sciences, Education, and Languages at HELP University [ERB Approval Code: N/A]. For any research-related problems or questions regarding participants' rights, please contact the Chairperson of the Ethics Review Board.</p>
                    <p style="margin-top: 15px;"><strong>Chairperson, Ethics Review Board</strong><br>
                    Department of Psychology, Faculty of Behavioural Sciences<br>
                    Level 3, Block B HELP University ‚Äì Subang 2<br>
                    Persiaran Cakerawala, Seksyen U4, 40150 Shah Alam<br>
                    Selangor Darul Ehsan<br>
                    Malaysia<br>
                    üìß Email: <a href="mailto:psych.erb@help.edu.my" style="color: #555; text-decoration: underline;">psych.erb@help.edu.my</a><br>
                    üìû Phone: +603 7849 3000</p>
                    <p style="margin-top: 15px;">For any enquiries of this study, please feel free to contact the researcher via the email addresses as stated below:</p>
                </div>

                <div class="info-box">
                    <h3>Contact Information</h3>
                    <p><strong>Researcher's supervisor:</strong><br>
                    Ms. Khor Khai Ling<br>
                    üìß Email: <a href="mailto:khailing.k@help.edu.my" style="color: #555; text-decoration: underline;">khailing.k@help.edu.my</a></p>

                    <p style="margin-top: 10px;"><strong>Researcher:</strong><br>
                    Pang Jia Hui<br>
                    üìß Email: <a href="mailto:B2300221@helplive.edu.my" style="color: #555; text-decoration: underline;">B2300221@helplive.edu.my</a></p>
                </div>

                <div class="form-group" style="margin-top: 30px;">
                    <label style="font-size: 16px; font-weight: 600;">Consent Statement: <span class="required">*</span></label>
                    <p style="margin: 10px 0; color: #555;">I have read and understand the explanation provided to me, and I voluntarily agree to participate in this study.</p>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectConsent('agree')">
                            <input type="radio" id="consent-agree" name="consent" value="agree" required>
                            <label for="consent-agree">I Agree</label>
                        </div>
                        <div class="radio-option" onclick="selectConsent('disagree')">
                            <input type="radio" id="consent-disagree" name="consent" value="disagree">
                            <label for="consent-disagree">I Disagree</label>
                        </div>
                    </div>
                    <div class="error" id="consent-error">Please select an option to continue</div>
                </div>

                <div class="buttons">
                    <button class="btn-primary" onclick="nextSection(1)">Continue ‚Üí</button>
                </div>
            </div>

            <!-- Section 2: Demographics -->
            <div class="section" id="section2">
                <h2>Demographic Information</h2>
                <p style="color: #666; margin-bottom: 20px;">All information obtained will be fully confidential and will only be used for the purpose of this study.</p>

                <div class="form-group">
                    <label>Age <span class="required">*</span></label>
                    <input type="number" id="age" min="18" max="25" placeholder="Enter your age" required>
                    <div class="error" id="age-error">Please enter your age (18-25)</div>
                </div>

                <div class="form-group">
                    <label>Gender <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectOption('gender', 'male')">
                            <input type="radio" id="gender-male" name="gender" value="male" required>
                            <label for="gender-male">Male</label>
                        </div>
                        <div class="radio-option" onclick="selectOption('gender', 'female')">
                            <input type="radio" id="gender-female" name="gender" value="female">
                            <label for="gender-female">Female</label>
                        </div>
                        <div class="radio-option" onclick="selectOption('gender', 'prefer-not')">
                            <input type="radio" id="gender-prefer" name="gender" value="prefer-not">
                            <label for="gender-prefer">Prefer not to say</label>
                        </div>
                    </div>
                    <div class="error" id="gender-error">Please select your gender</div>
                </div>

                <div class="form-group">
                    <label>Field of Study <span class="required">*</span></label>
                    <select id="field" required>
                        <option value="">Select your field of study</option>
                        <option value="arts">Arts, Humanities & Social Sciences</option>
                        <option value="business">Business, Accounting & Management</option>
                        <option value="stem">Science, Technology & Engineering (STEM)</option>
                        <option value="medicine">Medicine, Health Sciences & Nursing</option>
                        <option value="other">Other</option>
                    </select>
                    <input type="text" id="field-other" placeholder="Please specify" style="margin-top: 10px; display: none;">
                    <div class="error" id="field-error">Please select your field of study</div>
                </div>

                <div class="form-group">
                    <label>Level of Education <span class="required">*</span></label>
                    <select id="education" required>
                        <option value="">Select your education level</option>
                        <option value="foundation">Foundation</option>
                        <option value="bachelors">Bachelor's Degree</option>
                        <option value="masters">Master's Degree</option>
                        <option value="phd">PhD</option>
                    </select>
                    <div class="error" id="education-error">Please select your education level</div>
                </div>

                <div class="form-group">
                    <label>Nationality <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectOption('nationality', 'malaysian')">
                            <input type="radio" id="nationality-malaysian" name="nationality" value="malaysian" required>
                            <label for="nationality-malaysian">Malaysian</label>
                        </div>
                        <div class="radio-option" onclick="selectOption('nationality', 'other')">
                            <input type="radio" id="nationality-other" name="nationality" value="other">
                            <label for="nationality-other">Other</label>
                        </div>
                    </div>
                    <input type="text" id="nationality-specify" placeholder="Please specify" style="margin-top: 10px; display: none;">
                    <div class="error" id="nationality-error">Please select your nationality</div>
                </div>

                 <div class="form-group">
                    <label>Do you have normal colour vision (with or without correction)? <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectOption('colorvision', 'yes')">
                            <input type="radio" id="colorvision-yes" name="colorvision" value="yes" required>
                            <label for="colorvision-yes">Yes</label>
                        </div>
                        <div class="radio-option" onclick="selectOption('colorvision', 'no')">
                            <input type="radio" id="colorvision-no" name="colorvision" value="no">
                            <label for="colorvision-no">No</label>
                        </div>
                    </div>
                    <div class="error" id="colorvision-error">Please select an option</div>
                </div>

                <div class="form-group">
                    <label>Have you ever been diagnosed with an anxiety disorder or obsessive‚Äìcompulsive disorder (OCD)? <span class="required">*</span></label>
                    <div class="radio-group">
                        <div class="radio-option" onclick="selectOption('anxietyocd', 'yes')">
                            <input type="radio" id="anxietyocd-yes" name="anxietyocd" value="yes" required>
                            <label for="anxietyocd-yes">Yes</label>
                        </div>
                        <div class="radio-option" onclick="selectOption('anxietyocd', 'no')">
                            <input type="radio" id="anxietyocd-no" name="anxietyocd" value="no">
                            <label for="anxietyocd-no">No</label>
                        </div>
                    </div>
                    <div class="error" id="anxietyocd-error">Please select an option</div>
                </div>
                
                <div class="buttons">
                    <button class="btn-secondary" onclick="previousSection(2)">‚Üê Back</button>
                    <button class="btn-primary" onclick="nextSection(2)">Continue ‚Üí</button>
                </div>
            </div>

            <!-- Section 3: IUS-12 Scale -->
            <div class="section" id="section3">
                <h2>Intolerance of Uncertainty Scale (IUS-12)</h2>
                <p style="color: #666; margin-bottom: 20px;">The following statements measure how you react to uncertain or unpredictable situations. Please indicate how much each statement describes you. There are no right or wrong answers.</p>

                <div class="info-box">
                    <p><strong>Scale:</strong></p>
                    <p>1 = Not at all characteristic of me</p>
                    <p>2 = A little characteristic of me</p>
                    <p>3 = Somewhat characteristic of me</p>
                    <p>4 = Very characteristic of me</p>
                    <p>5 = Entirely characteristic of me</p>
                </div>

                <div id="ius-questions"></div>

                <div class="buttons">
                    <button class="btn-secondary" onclick="previousSection(3)">‚Üê Back</button>
                    <button class="btn-primary" onclick="nextSection(3)">Continue ‚Üí</button>
                </div>
            </div>

            <!-- Section 4: Information Sampling Task -->
            <div class="section" id="section4">
                <!-- General Instructions -->
                <div id="generalInstructions">
                    <h2>Information Sampling Task</h2>
                    
                    <div class="info-box">
                        <h3>General Instructions</h3>
                        <p>Welcome to the Information Sampling Task! In this task, you will make decisions based on information you gather.</p>
                        <p><strong>How it works:</strong></p>
                        <ul>
                            <li>You will see a grid of 25 colored boxes (hidden initially)</li>
                            <li>Behind each box is either a <strong>BLUE</strong> or <strong>ORANGE</strong> color</li>
                            <li>Your goal is to determine which color is the <strong>majority</strong> (appears more frequently)</li>
                            <li>Click on boxes to reveal their colors</li>
                            <li>When you feel confident, click either <strong>"Orange is More Common"</strong> or <strong>"Blue is More Common"</strong> button to submit your answer</li>
                        </ul>
                        <p style="margin-top: 15px;">This task has <strong>two parts</strong> with 10 trials each, totaling 20 trials.</p>
                    </div>

                    <div class="buttons">
                        <button class="btn-secondary" onclick="previousSection(4)">‚Üê Back</button>
                        <button class="btn-primary" onclick="showFWInstructions()">Continue ‚Üí</button>
                    </div>
                </div>

                <!-- Fixed Win Instructions -->
                <div id="fwInstructions" style="display: none;">
                    <h2>Part 1: Fixed Win Condition</h2>
                    
                    <div class="info-box" style="border-left-color: #28a745;">
                        <h3>üéØ Fixed Win Instructions</h3>
                        <p><strong>Scoring System:</strong></p>
                        <ul>
                            <li>Each trial: <strong>100 points</strong> for a correct decision</li>
                            <li><strong>0 points</strong> for an incorrect decision</li>
                            <li><strong>No penalty</strong> for opening more boxes</li>
                        </ul>
                        <p style="margin-top: 15px; padding: 15px; background: #d4edda; border-radius: 5px;">
                            üí° <strong>Take your time!</strong> You can open as many boxes as you need to feel confident about your decision. The reward stays the same regardless of how many boxes you open.
                        </p>
                    </div>

                    <div class="info-box">
                        <h3>What to do:</h3>
                        <p>1. Click on boxes to reveal their colors</p>
                        <p>2. Observe the colors: BLUE or ORANGE</p>
                        <p>3. When ready, click either <strong>"Orange is More Common"</strong> or <strong>"Blue is More Common"</strong> button</p>
                        <p>4. Complete all 10 trials</p>
                    </div>

                    <div class="buttons">
                        <button class="btn-secondary" onclick="showGeneralInstructions()">‚Üê Back</button>
                        <button class="btn-primary" onclick="startFWTrials()">Start Fixed Win Trials ‚Üí</button>
                    </div>
                </div>

                <!-- Fixed Win Trials -->
                <div id="fwTrials" style="display: none;">
                    <h2>Fixed Win Condition - Trial <span id="fwTrialNumber">1</span> of 10</h2>
                    
                    <div class="task-container">
                        <div class="task-info">
                            <p><strong>Trial Progress:</strong> <span id="fwProgress">1/10</span></p>
                            <p><strong>Total Score:</strong> <span id="fwTotalScore">0</span> points</p>
                            <p style="color: #28a745; font-weight: 600; margin-top: 10px;">Fixed Win: 100 points for correct choice, no penalty for sampling</p>
                        </div>

                        <div class="task-info" style="background: white;">
                            <p><strong>Boxes Revealed:</strong> <span id="fwRevealCount">0</span> / 25</p>
                            <p><strong>Blue:</strong> <span id="fwBlueCount">0</span> | <strong>Orange:</strong> <span id="fwOrangeCount">0</span></p>
                        </div>

                        <div class="color-grid" id="fwColorGrid"></div>

                        <div class="task-buttons">
                            <button class="btn-decision btn-orange" onclick="makeFWDecision('orange')" id="fwDecisionBtnOrange">Orange is More Common</button>
                            <button class="btn-decision btn-blue" onclick="makeFWDecision('blue')" id="fwDecisionBtnBlue">Blue is More Common</button>
                        </div>

                        <div id="fwDecisionResult" style="margin-top: 20px; display: none;"></div>
                    </div>

                    <div class="buttons" style="margin-top: 30px;">
                        <button class="btn-primary" onclick="nextFWTrial()" id="fwNextBtn" style="display: none;">Next Trial ‚Üí</button>
                    </div>
                </div>

                <!-- Decreasing Win Instructions -->
                <div id="dwInstructions" style="display: none;">
                    <h2>Part 2: Decreasing Win Condition</h2>
                    
                    <div class="info-box" style="border-left-color: #ffc107;">
                        <h3>‚ö° Decreasing Win Instructions</h3>
                        <p><strong>Scoring System:</strong></p>
                        <ul>
                            <li>Each trial starts with <strong>100 points</strong></li>
                            <li>Every box you open <strong>reduces the reward by 10 points</strong></li>
                            <li>Formula: <strong>Points = 100 - (boxes opened √ó 10)</strong></li>
                            <li>Incorrect decisions still earn <strong>0 points</strong></li>
                        </ul>
                        <p style="margin-top: 15px; padding: 15px; background: #fff3cd; border-radius: 5px;">
                            üí° <strong>Take your time!</strong> You can open as many boxes as you need to feel confident about your decision.
                        </p>
                    </div>

                    <div class="info-box">
                        <h3>Example:</h3>
                        <p>‚Ä¢ Open 2 boxes and make correct decision: <strong>80 points</strong> (100 - 2√ó10)</p>
                        <p>‚Ä¢ Open 5 boxes and make correct decision: <strong>50 points</strong> (100 - 5√ó10)</p>
                        <p>‚Ä¢ Open 8 boxes and make correct decision: <strong>20 points</strong> (100 - 8√ó10)</p>
                        <p style="color: #dc3545; font-weight: 600;">‚Ä¢ Make incorrect decision: <strong>0 points</strong> (regardless of boxes opened)</p>
                    </div>

                    <div class="buttons">
                        <button class="btn-primary" onclick="startDWTrials()">Start Decreasing Win Trials ‚Üí</button>
                    </div>
                </div>

                <!-- Decreasing Win Trials -->
                <div id="dwTrials" style="display: none;">
                    <h2>Decreasing Win Condition - Trial <span id="dwTrialNumber">1</span> of 10</h2>
                    
                    <div class="task-container">
                        <div class="task-info">
                            <p><strong>Trial Progress:</strong> <span id="dwProgress">1/10</span></p>
                            <p><strong>Total Score:</strong> <span id="dwTotalScore">0</span> points</p>
                            <p style="color: #ffc107; font-weight: 600; margin-top: 10px;">Decreasing Win: Points decrease by 10 for each box opened</p>
                        </div>

                        <div class="task-info" style="background: white;">
                            <p><strong>Boxes Revealed:</strong> <span id="dwRevealCount">0</span> / 25</p>
                            <p><strong>Current Potential Points:</strong> <span id="dwPotentialPoints" style="font-size: 18px; font-weight: 700; color: #667eea;">100</span></p>
                            <p><strong>Blue:</strong> <span id="dwBlueCount">0</span> | <strong>Orange:</strong> <span id="dwOrangeCount">0</span></p>
                        </div>

                        <div class="color-grid" id="dwColorGrid"></div>

                        <div class="task-buttons">
                            <button class="btn-decision btn-orange" onclick="makeDWDecision('orange')" id="dwDecisionBtnOrange">Orange is More Common</button>
                            <button class="btn-decision btn-blue" onclick="makeDWDecision('blue')" id="dwDecisionBtnBlue">Blue is More Common</button>
                        </div>

                        <div id="dwDecisionResult" style="margin-top: 20px; display: none;"></div>
                    </div>

                    <div class="buttons" style="margin-top: 30px;">
                        <button class="btn-primary" onclick="nextDWTrial()" id="dwNextBtn" style="display: none;">Next Trial ‚Üí</button>
                        <button class="btn-primary" onclick="nextSection(4)" id="taskCompleteBtn" style="display: none;">Continue to Summary ‚Üí</button>
                    </div>
                </div>
            </div>

            <!-- Section 5: Thank You -->
            <div class="section" id="section5">
                <div class="thank-you">
                    <div class="emoji">üéâ</div>
                    <h2>Thank You for Contributing!</h2>
                    <p>We truly appreciate you taking the time to complete this survey. Your responses are invaluable and will help us better understand how intolerance of uncertainty relates to behavioral indecisiveness in emerging adults. By combining self-report measures with a behavioral task, you've contributed to a more comprehensive, multi-method approach to studying indecisiveness.</p>

                    <h3 style="color: #667eea; margin-top: 25px; margin-bottom: 10px;">‚ú® What happens next?</h3>
                    <ul style="text-align: left; max-width: 600px; margin: 0 auto; line-height: 1.8;">
                        <li>Your responses will remain completely confidential and used solely for academic research purposes.</li>
                        <li>Your input will directly help shape future studies and interventions in this area.</li>
                    </ul>

                    <p style="margin-top: 25px;"><strong>üí° Fun Fact:</strong> Every participant like you helps us paint a clearer picture of decision-making processes‚Äîso you're making a real difference!</p>
                    
                    <p style="margin-top: 25px; font-weight: 600; color: #667eea;">üåº Thank you again for your time and support. Your participation truly matters!</p>
                    
                    <button class="btn-submit" onclick="submitForm()" style="margin-top: 30px;">Submit Survey</button>
                </div>
            </div>
        </div>
    </div>

    <script data-cfasync="false" src="/cdn-cgi/scripts/5c5dd728/cloudflare-static/email-decode.min.js"></script><script>
        let currentSection = 1;
        const totalSections = 5;
        
        // Time tracking
        let surveyStartTime = new Date();
        let participantID = 'P' + Date.now() + Math.random().toString(36).substr(2, 9);
        
        // Fixed Win trial variables
        let fwTrialNum = 1;
        let fwTotalScore = 0;
        let fwColorArray = [];
        let fwRevealedCount = 0;
        let fwTrialData = [];
        
        // Decreasing Win trial variables
        let dwTrialNum = 1;
        let dwTotalScore = 0;
        let dwColorArray = [];
        let dwRevealedCount = 0;
        let dwTrialData = [];

        // IUS-12 Questions
        const iusQuestions = [
            "Unforeseen events upset me greatly.",
            "It frustrates me not having all the information I need.",
            "One should always look ahead so as to avoid surprises.",
            "A small, unforeseen event can spoil everything, even with the best of planning.",
            "I always want to know what the future has in store for me.",
            "I can't stand being taken by surprise.",
            "I should be able to organize everything in advance.",
            "Uncertainty keeps me from living a full life.",
            "When it's time to act, uncertainty paralyses me.",
            "When I am uncertain I can't function very well.",
            "The smallest doubt can stop me from acting.",
            "I must get away from all uncertain situations."
        ];

        // Initialize
        document.addEventListener('DOMContentLoaded', function() {
            generateIUSQuestions();
            updateProgress();

            // Field of study change handler
            document.getElementById('field').addEventListener('change', function() {
                document.getElementById('field-other').style.display = 
                    this.value === 'other' ? 'block' : 'none';
            });

            // Nationality change handler
            document.querySelectorAll('input[name="nationality"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    document.getElementById('nationality-specify').style.display = 
                        this.value === 'other' ? 'block' : 'none';
                });
            });
        });

        function generateIUSQuestions() {
            const container = document.getElementById('ius-questions');
            const scaleLabels = [
                'Not at all characteristic of me',
                'A little characteristic of me',
                'Somewhat characteristic of me',
                'Very characteristic of me',
                'Entirely characteristic of me'
            ];
            
            iusQuestions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'ius-question';
                questionDiv.innerHTML = `
                    <p><strong>Q${index + 1}.</strong> ${question}</p>
                    <div class="likert-scale">
                        ${[1, 2, 3, 4, 5].map(value => `
                            <div class="likert-option">
                                <input type="radio" id="ius${index}-${value}" name="ius${index}" value="${value}" required>
                                <label for="ius${index}-${value}">
                                    <span class="likert-number">${value}</span>
                                    <span class="likert-label">${scaleLabels[value - 1]}</span>
                                </label>
                            </div>
                        `).join('')}
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        // Navigation functions for instruction screens
        function showGeneralInstructions() {
            document.getElementById('generalInstructions').style.display = 'block';
            document.getElementById('fwInstructions').style.display = 'none';
        }

        function showFWInstructions() {
            document.getElementById('generalInstructions').style.display = 'none';
            document.getElementById('fwInstructions').style.display = 'block';
        }

        function startFWTrials() {
            document.getElementById('fwInstructions').style.display = 'none';
            document.getElementById('fwTrials').style.display = 'block';
            initializeFWTrial();
        }

        function startDWTrials() {
            document.getElementById('dwInstructions').style.display = 'none';
            document.getElementById('dwTrials').style.display = 'block';
            initializeDWTrial();
        }

        // Fixed Win Trial Functions
        function initializeFWTrial() {
            // Generate random color array (60% one color, 40% other)
            const majorityColor = Math.random() < 0.5 ? 'blue' : 'orange';
            fwColorArray = [];
            
            for (let i = 0; i < 15; i++) {
                fwColorArray.push(majorityColor);
            }
            for (let i = 0; i < 10; i++) {
                fwColorArray.push(majorityColor === 'blue' ? 'orange' : 'blue');
            }
            
            // Shuffle array
            fwColorArray.sort(() => Math.random() - 0.5);
            fwRevealedCount = 0;

            // Create grid
            const grid = document.getElementById('fwColorGrid');
            grid.innerHTML = ''; // Clear existing grid
            fwColorArray.forEach((color, index) => {
                const box = document.createElement('div');
                box.className = 'color-box hidden';
                box.dataset.color = color;
                box.dataset.index = index;
                box.onclick = () => revealFWBox(index);
                grid.appendChild(box);
            });

            // Reset displays
            document.getElementById('fwRevealCount').textContent = '0';
            document.getElementById('fwBlueCount').textContent = '0';
            document.getElementById('fwOrangeCount').textContent = '0';
            document.getElementById('fwDecisionResult').style.display = 'none';
            document.getElementById('fwDecisionBtnOrange').disabled = false;
            document.getElementById('fwDecisionBtnBlue').disabled = false;
            document.getElementById('fwNextBtn').style.display = 'none';
        }

        function revealFWBox(index) {
            const boxes = document.querySelectorAll('#fwColorGrid .color-box');
            const box = boxes[index];
            
            if (box.classList.contains('revealed')) return;

            box.classList.remove('hidden');
            box.classList.add('revealed');
            const color = box.dataset.color;
            box.style.background = color === 'blue' ? '#3B82F6' : '#F97316';
            
            fwRevealedCount++;
            updateFWTaskCounts();
        }

        function updateFWTaskCounts() {
            const revealed = document.querySelectorAll('#fwColorGrid .color-box.revealed');
            let blueCount = 0;
            let orangeCount = 0;

            revealed.forEach(box => {
                if (box.dataset.color === 'blue') blueCount++;
                else orangeCount++;
            });

            document.getElementById('fwRevealCount').textContent = fwRevealedCount;
            document.getElementById('fwBlueCount').textContent = blueCount;
            document.getElementById('fwOrangeCount').textContent = orangeCount;
        }

        function makeFWDecision(decision) {
            if (fwRevealedCount === 0) {
                alert('Please reveal at least one box before making a decision.');
                return;
            }

            // Reveal all boxes
            const boxes = document.querySelectorAll('#fwColorGrid .color-box');
            boxes.forEach(box => {
                box.classList.remove('hidden');
                box.classList.add('revealed');
                const color = box.dataset.color;
                box.style.background = color === 'blue' ? '#3B82F6' : '#F97316';
            });

            // Calculate actual majority
            const actualBlue = fwColorArray.filter(c => c === 'blue').length;
            const actualOrange = fwColorArray.filter(c => c === 'orange').length;
            const actualMajority = actualBlue > actualOrange ? 'blue' : 'orange';

            const correct = decision === actualMajority;
            const pointsEarned = correct ? 100 : 0;
            fwTotalScore += pointsEarned;
            
            // Store trial data
            fwTrialData.push({
                trial: fwTrialNum,
                condition: 'Fixed Win',
                boxesRevealed: fwRevealedCount,
                decision: decision,
                correctAnswer: actualMajority,
                correct: correct,
                pointsEarned: pointsEarned
            });

            const resultDiv = document.getElementById('fwDecisionResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div class="info-box" style="border-left-color: ${correct ? '#28a745' : '#dc3545'};">
                    <h3>${correct ? '‚úì Correct!' : '‚úó Incorrect'}</h3>
                    <p>You decided: <strong>${decision.toUpperCase()}</strong></p>
                    <p>Actual majority: <strong>${actualMajority.toUpperCase()}</strong> (${actualMajority === 'blue' ? actualBlue : actualOrange} out of 25)</p>
                    <p>Boxes revealed: <strong>${fwRevealedCount}</strong></p>
                    <p style="font-size: 18px; font-weight: 700; color: ${correct ? '#28a745' : '#dc3545'}; margin-top: 10px;">
                        Points earned: ${pointsEarned}
                    </p>
                </div>
            `;

            document.getElementById('fwTotalScore').textContent = fwTotalScore;
            document.getElementById('fwDecisionBtnOrange').disabled = true;
            document.getElementById('fwDecisionBtnBlue').disabled = true;
            document.getElementById('fwNextBtn').style.display = 'block';
        }

        function nextFWTrial() {
            if (fwTrialNum < 10) {
                fwTrialNum++;
                document.getElementById('fwTrialNumber').textContent = fwTrialNum;
                document.getElementById('fwProgress').textContent = `${fwTrialNum}/10`;
                initializeFWTrial();
            } else {
                // Move to DW instructions
                document.getElementById('fwTrials').style.display = 'none';
                document.getElementById('dwInstructions').style.display = 'block';
            }
        }

        // Decreasing Win Trial Functions
        function initializeDWTrial() {
            // Generate random color array (60% one color, 40% other)
            const majorityColor = Math.random() < 0.5 ? 'blue' : 'orange';
            dwColorArray = [];
            
            for (let i = 0; i < 15; i++) {
                dwColorArray.push(majorityColor);
            }
            for (let i = 0; i < 10; i++) {
                dwColorArray.push(majorityColor === 'blue' ? 'orange' : 'blue');
            }
            
            // Shuffle array
            dwColorArray.sort(() => Math.random() - 0.5);
            dwRevealedCount = 0;

            // Create grid
            const grid = document.getElementById('dwColorGrid');
            grid.innerHTML = ''; // Clear existing grid
            dwColorArray.forEach((color, index) => {
                const box = document.createElement('div');
                box.className = 'color-box hidden';
                box.dataset.color = color;
                box.dataset.index = index;
                box.onclick = () => revealDWBox(index);
                grid.appendChild(box);
            });

            // Reset displays
            document.getElementById('dwRevealCount').textContent = '0';
            document.getElementById('dwPotentialPoints').textContent = '100';
            document.getElementById('dwBlueCount').textContent = '0';
            document.getElementById('dwOrangeCount').textContent = '0';
            document.getElementById('dwDecisionResult').style.display = 'none';
            document.getElementById('dwDecisionBtnOrange').disabled = false;
            document.getElementById('dwDecisionBtnBlue').disabled = false;
            document.getElementById('dwNextBtn').style.display = 'none';
        }

        function revealDWBox(index) {
            const boxes = document.querySelectorAll('#dwColorGrid .color-box');
            const box = boxes[index];
            
            if (box.classList.contains('revealed')) return;

            box.classList.remove('hidden');
            box.classList.add('revealed');
            const color = box.dataset.color;
            box.style.background = color === 'blue' ? '#3B82F6' : '#F97316';
            
            dwRevealedCount++;
            updateDWTaskCounts();
        }

        function updateDWTaskCounts() {
            const revealed = document.querySelectorAll('#dwColorGrid .color-box.revealed');
            let blueCount = 0;
            let orangeCount = 0;

            revealed.forEach(box => {
                if (box.dataset.color === 'blue') blueCount++;
                else orangeCount++;
            });

            const potentialPoints = Math.max(0, 100 - (dwRevealedCount * 10));

            document.getElementById('dwRevealCount').textContent = dwRevealedCount;
            document.getElementById('dwPotentialPoints').textContent = potentialPoints;
            document.getElementById('dwBlueCount').textContent = blueCount;
            document.getElementById('dwOrangeCount').textContent = orangeCount;
        }

        function makeDWDecision(decision) {
            if (dwRevealedCount === 0) {
                alert('Please reveal at least one box before making a decision.');
                return;
            }

            // Reveal all boxes
            const boxes = document.querySelectorAll('#dwColorGrid .color-box');
            boxes.forEach(box => {
                box.classList.remove('hidden');
                box.classList.add('revealed');
                const color = box.dataset.color;
                box.style.background = color === 'blue' ? '#3B82F6' : '#F97316';
            });

            // Calculate actual majority
            const actualBlue = dwColorArray.filter(c => c === 'blue').length;
            const actualOrange = dwColorArray.filter(c => c === 'orange').length;
            const actualMajority = actualBlue > actualOrange ? 'blue' : 'orange';

            const correct = decision === actualMajority;
            const potentialPoints = Math.max(0, 100 - (dwRevealedCount * 10));
            const pointsEarned = correct ? potentialPoints : 0;
            dwTotalScore += pointsEarned;
            
            // Store trial data
            dwTrialData.push({
                trial: dwTrialNum,
                condition: 'Decreasing Win',
                boxesRevealed: dwRevealedCount,
                decision: decision,
                correctAnswer: actualMajority,
                correct: correct,
                pointsEarned: pointsEarned
            });

            const resultDiv = document.getElementById('dwDecisionResult');
            resultDiv.style.display = 'block';
            resultDiv.innerHTML = `
                <div class="info-box" style="border-left-color: ${correct ? '#28a745' : '#dc3545'};">
                    <h3>${correct ? '‚úì Correct!' : '‚úó Incorrect'}</h3>
                    <p>You decided: <strong>${decision.toUpperCase()}</strong></p>
                    <p>Actual majority: <strong>${actualMajority.toUpperCase()}</strong> (${actualMajority === 'blue' ? actualBlue : actualOrange} out of 25)</p>
                    <p>Boxes revealed: <strong>${dwRevealedCount}</strong></p>
                    <p>Calculation: 100 - (${dwRevealedCount} √ó 10) = ${potentialPoints} points</p>
                    <p style="font-size: 18px; font-weight: 700; color: ${correct ? '#28a745' : '#dc3545'}; margin-top: 10px;">
                        Points earned: ${pointsEarned}
                    </p>
                </div>
            `;

            document.getElementById('dwTotalScore').textContent = dwTotalScore;
            document.getElementById('dwDecisionBtnOrange').disabled = true;
            document.getElementById('dwDecisionBtnBlue').disabled = true;
            document.getElementById('dwNextBtn').style.display = dwTrialNum < 10 ? 'block' : 'none';
            document.getElementById('taskCompleteBtn').style.display = dwTrialNum === 10 ? 'block' : 'none';
        }

        function nextDWTrial() {
            if (dwTrialNum < 10) {
                dwTrialNum++;
                document.getElementById('dwTrialNumber').textContent = dwTrialNum;
                document.getElementById('dwProgress').textContent = `${dwTrialNum}/10`;
                initializeDWTrial();
            }
        }

        function selectConsent(value) {
            document.getElementById(`consent-${value}`).checked = true;
            document.querySelectorAll('.radio-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function selectOption(name, value) {
            const radio = document.getElementById(`${name}-${value}`);
            radio.checked = true;
            
            // Update visual selection for this radio group
            const radioGroup = radio.closest('.radio-group');
            radioGroup.querySelectorAll('.radio-option').forEach(option => {
                option.classList.remove('selected');
            });
            event.currentTarget.classList.add('selected');
        }

        function validateSection(section) {
            let isValid = true;

            if (section === 1) {
                const consent = document.querySelector('input[name="consent"]:checked');
                if (!consent) {
                    document.getElementById('consent-error').style.display = 'block';
                    isValid = false;
                } else if (consent.value === 'disagree') {
                    alert('You must agree to the consent form to participate in this study.');
                    isValid = false;
                } else {
                    document.getElementById('consent-error').style.display = 'none';
                }
            }

            if (section === 2) {
                const age = document.getElementById('age').value;
                const gender = document.querySelector('input[name="gender"]:checked');
                const field = document.getElementById('field').value;
                const education = document.getElementById('education').value;
                const nationality = document.querySelector('input[name="nationality"]:checked');

                if (!age || age < 18 || age > 25) {
                    document.getElementById('age-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('age-error').style.display = 'none';
                }

                if (!gender) {
                    document.getElementById('gender-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('gender-error').style.display = 'none';
                }

                if (!field) {
                    document.getElementById('field-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('field-error').style.display = 'none';
                }

                if (!education) {
                    document.getElementById('education-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('education-error').style.display = 'none';
                }

                if (!nationality) {
                    document.getElementById('nationality-error').style.display = 'block';
                    isValid = false;
                } else {
                    document.getElementById('nationality-error').style.display = 'none';
                }
            }

            if (section === 3) {
                let allAnswered = true;
                for (let i = 0; i < iusQuestions.length; i++) {
                    const answered = document.querySelector(`input[name="ius${i}"]:checked`);
                    if (!answered) {
                        allAnswered = false;
                        break;
                    }
                }
                if (!allAnswered) {
                    alert('Please answer all questions before continuing.');
                    isValid = false;
                }
            }

            if (section === 4) {
                if (dwTrialNum < 10 || dwTrialData.length < 10) {
                    alert('Please complete all 20 trials (10 Fixed Win + 10 Decreasing Win) before continuing.');
                    isValid = false;
                }
            }

            return isValid;
        }

        function nextSection(current) {
            if (!validateSection(current)) return;

            if (current < totalSections) {
                document.getElementById(`section${current}`).classList.remove('active');
                currentSection = current + 1;
                document.getElementById(`section${currentSection}`).classList.add('active');
                
                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        function populateSummary() {
            // Summary removed - function kept for compatibility
        }

        function previousSection(current) {
            if (current > 1) {
                document.getElementById(`section${current}`).classList.remove('active');
                currentSection = current - 1;
                document.getElementById(`section${currentSection}`).classList.add('active');
                updateProgress();
                window.scrollTo(0, 0);
            }
        }

        function updateProgress() {
            const progress = ((currentSection - 1) / (totalSections - 1)) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function submitForm() {
            // Calculate time taken
            const surveyEndTime = new Date();
            const timeTakenSeconds = Math.round((surveyEndTime - surveyStartTime) / 1000);
            
            // Format IUS responses to match Apps Script structure
            const iusResponsesObj = {};
            let iusTotal = 0;
            for (let i = 0; i < iusQuestions.length; i++) {
                const response = document.querySelector(`input[name="ius${i}"]:checked`)?.value;
                const responseValue = parseInt(response) || 0;
                iusResponsesObj['q' + (i + 1)] = responseValue;
                iusTotal += responseValue;
            }
            
            // Combine Fixed Win and Decreasing Win trials into IST trials
            const istTrials = [];
            
            // Add Fixed Win trials
            fwTrialData.forEach(trial => {
                istTrials.push({
                    condition: trial.condition,
                    boxesRevealed: trial.boxesRevealed,
                    decision: trial.decision,
                    correctAnswer: trial.correctAnswer,
                    correct: trial.correct,
                    pointsEarned: trial.pointsEarned
                });
            });
            
            // Add Decreasing Win trials
            dwTrialData.forEach(trial => {
                istTrials.push({
                    condition: trial.condition,
                    boxesRevealed: trial.boxesRevealed,
                    decision: trial.decision,
                    correctAnswer: trial.correctAnswer,
                    correct: trial.correct,
                    pointsEarned: trial.pointsEarned
                });
            });
            
            // Format data to match Apps Script structure
            const formData = {
                participantID: participantID,
                timeTaken: timeTakenSeconds,
                demographics: {
                    age: document.getElementById('age').value,
                    gender: document.querySelector('input[name="gender"]:checked')?.value,
                    fieldOfStudy: document.getElementById('field').value,
                    education: document.getElementById('education').value,
                    nationality: document.querySelector('input[name="nationality"]:checked')?.value
                },
                iusResponses: iusResponsesObj,
                iusTotal: iusTotal,
                istTrials: istTrials
            };
            
            console.log('Form Data:', formData);
            
            // Send data to Google Sheets
            const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbymBrb1ISC5w-4lYKEkz38emtMDBBcT85Vo9oGKj3bKCS8ia7mDey1C4RI0-PrFpC0KGw/exec';
            
           document.getElementById('loadingOverlay').style.display = 'flex';
            
            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(response => { 
    document.getElementById('loadingOverlay').style.display = 'none';
    alert('Thank you for completing the survey. Your response has been recorded!');
    window.location.reload();
})
.catch(error => {
    document.getElementById('loadingOverlay').style.display = 'none';
    console.error('Error:', error);
    alert('Thank you for completing the survey. Your response has been recorded!');
    window.location.reload();
});
        }

        // Initialize on page load
        window.addEventListener('load', function() {
            updateProgress();
        });

        // Add field selection handler
        document.addEventListener('DOMContentLoaded', function() {
            const fieldSelect = document.getElementById('field');
            const fieldOther = document.getElementById('field-other');
            
            if (fieldSelect) {
                fieldSelect.addEventListener('change', function() {
                    if (this.value === 'other') {
                        fieldOther.style.display = 'block';
                    } else {
                        fieldOther.style.display = 'none';
                    }
                });
            }
        });
    </script>

    <div id="loadingOverlay">
        <div class="loader-box">
            <div class="loader-text">Submitting your responses...</div>
            <div class="loader-bar">
                <div class="loader-fill"></div>
            </div>
        </div>
    </div>
</body>
</html>
