<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Cognitive Cost of Not Knowing: Intolerance of Uncertainty and Indecisiveness in University Students</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            overflow: hidden;
            margin-bottom: 40px;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .content {
            padding: 40px;
        }

        .section {
            display: none;
            animation: fadeIn 0.5s;
        }

        .section.active {
            display: block;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .progress-bar {
            height: 6px;
            background: #e0e0e0;
            position: relative;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.5s ease;
        }

        h2 {
            color: #667eea;
            margin-bottom: 20px;
            font-size: 24px;
        }

        h3 {
            color: #333;
            margin: 20px 0 15px 0;
            font-size: 18px;
        }

        p, li {
            line-height: 1.8;
            color: #555;
            margin-bottom: 15px;
        }

        ul, ol {
            margin-left: 20px;
            margin-bottom: 20px;
        }

        .info-box {
            background: #f8f9fa;
            border-left: 4px solid #667eea;
            padding: 20px;
            margin: 20px 0;
            border-radius: 4px;
        }

        .contact-info {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        label {
            display: block;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        input[type="text"],
        input[type="number"],
        select {
            width: 100%;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            font-size: 16px;
            transition: border-color 0.3s;
        }

        input[type="text"]:focus,
        input[type="number"]:focus,
        select:focus {
            outline: none;
            border-color: #667eea;
        }

        .radio-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .radio-option {
            display: flex;
            align-items: center;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .radio-option:hover {
            border-color: #667eea;
            background: #f8f9fa;
        }

        .radio-option input[type="radio"] {
            margin-right: 12px;
            cursor: pointer;
        }

        /* Number box scale for IUS-12 */
        .number-scale {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            justify-content: center;
        }

        .number-box {
            width: 60px;
            height: 60px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            font-weight: bold;
            color: #666;
            cursor: pointer;
            transition: all 0.3s;
            user-select: none;
        }

        .number-box:hover {
            border-color: #667eea;
            background: #f8f9fa;
            transform: translateY(-2px);
        }

        .number-box.selected {
            background: #667eea;
            border-color: #667eea;
            color: white;
            transform: scale(1.1);
        }

        .scale-labels {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #666;
            margin-top: 10px;
        }

        .button-group {
            display: flex;
            gap: 15px;
            justify-content: space-between;
            margin-top: 30px;
            padding-top: 30px;
            border-top: 2px solid #e0e0e0;
        }

        button {
            padding: 14px 30px;
            font-size: 16px;
            font-weight: 600;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #e0e0e0;
            color: #333;
        }

        .btn-secondary:hover {
            background: #d0d0d0;
        }

        .btn-success {
            background: #28a745;
            color: white;
            font-size: 18px;
            padding: 16px 40px;
        }

        .btn-success:hover {
            background: #218838;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        button:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .error {
            color: #dc3545;
            font-size: 14px;
            margin-top: 5px;
            display: none;
        }

        /* Information Sampling Task */
        .ist-container {
            text-align: center;
            padding: 20px 0;
        }

        .ist-grid {
            display: inline-grid;
            grid-template-columns: repeat(5, 70px);
            gap: 12px;
            margin: 30px auto;
        }

        .ist-box {
            width: 70px;
            height: 70px;
            background: #95a5a6;
            border: 3px solid #7f8c8d;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 24px;
            color: white;
            transition: all 0.3s;
        }

        .ist-box:hover:not(.revealed) {
            transform: scale(1.05);
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .ist-box.revealed {
            cursor: default;
        }

        .ist-info {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 8px;
            margin: 20px auto;
            max-width: 500px;
        }

        .ist-counter {
            font-size: 20px;
            font-weight: 600;
            color: #667eea;
            margin: 20px 0;
        }

        .ist-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
            margin: 30px 0;
        }

        .ist-btn {
            padding: 15px 40px;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            color: white;
        }

        .ist-btn-red {
            background: #e74c3c;
        }

        .ist-btn-red:hover {
            background: #c0392b;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(231, 76, 60, 0.3);
        }

        .ist-btn-blue {
            background: #3498db;
        }

        .ist-btn-blue:hover {
            background: #2980b9;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(52, 152, 219, 0.3);
        }

        .result-message {
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
            font-weight: 600;
            animation: fadeIn 0.5s;
        }

        .result-message.correct {
            background: #d4edda;
            border: 2px solid #c3e6cb;
            color: #155724;
        }

        .result-message.incorrect {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            color: #721c24;
        }

        .trial-indicator {
            text-align: center;
            font-size: 18px;
            color: #667eea;
            font-weight: 600;
            margin-bottom: 20px;
        }

        #currentPoints, #totalScore {
            transition: color 0.3s ease, transform 0.3s ease;
        }

        @keyframes rotate {
            0%, 100% { transform: rotate(0deg); }
            25% { transform: rotate(-10deg); }
            75% { transform: rotate(10deg); }
        }

        @keyframes scaleIn {
            from { transform: scale(0); }
            to { transform: scale(1); }
        }

        .impact-item {
            transition: transform 0.2s, box-shadow 0.2s;
        }

        .impact-item:hover {
            transform: translateX(5px);
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
        }

        @media (max-width: 768px) {
            .content {
                padding: 20px;
            }

            .number-scale {
                justify-content: space-between;
            }

            .number-box {
                width: 50px;
                height: 50px;
                font-size: 20px;
            }

            .ist-grid {
                grid-template-columns: repeat(5, 55px);
                gap: 8px;
            }

            .ist-box {
                width: 55px;
                height: 55px;
                font-size: 20px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="progress-bar">
            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
        </div>

        <div class="header">
            <div style="font-size: 14px; opacity: 0.8; margin-bottom: 15px; letter-spacing: 2px; text-transform: uppercase;">Research Study</div>
            <h1 style="font-size: 32px; font-weight: 700; line-height: 1.3; text-shadow: 0 2px 4px rgba(0,0,0,0.2);">The Cognitive Cost of Not Knowing: Intolerance of Uncertainty and Indecisiveness in University Students</h1>
        </div>

        <div class="content">
            <!-- Informed Consent -->
            <div id="section1" class="section active">
                <h2>Informed Consent Form</h2>
                
                <p>Dear participants,</p>
                
                <p>You are invited to participate in a research study exploring <em>The Relationship between Intolerance of Uncertainty and Indecisiveness Among University Students</em>. Please read the information below carefully to understand the study's purpose, what your participation involves, and your rights as a participant.</p>

                <h3>Description of the study:</h3>
                <p>This study aims to examine the relationship between intolerance of uncertainty and indecisiveness among university students. Participants will complete a set of validated self-report questionnaires assessing intolerance of uncertainty, and a behavioural task for measuring the indecisiveness. This study contributes by providing empirical evidence on the relationship between intolerance of uncertainty and indecisiveness among university students.</p>

                <h3>To take part in this study, you must:</h3>
                <ul>
                    <li>Be aged between 18-30 years old</li>
                    <li>Be a current university student</li>
                    <li>Have normal color vision</li>
                    <li>Not have been diagnosed with psychological disorders</li>
                </ul>

                <h3>What will be done:</h3>
                <p>In this form, you will be asked to complete:</p>
                <ol>
                    <li>A demographic questionnaire</li>
                    <li>The Intolerance of Uncertainty Scale (IU-12, 12 items)</li>
                    <li>The Information Sampling Task</li>
                </ol>
                <p>This entire study will take no longer than 30 minutes to complete.</p>

                <div class="contact-info">
                    <h3>Risks and discomfort:</h3>
                    <p>No major risks are anticipated in this study. However, if you experience any discomfort during the study, you are free to close the Google Form without submitting your responses and will not be held responsible. If you experience any discomfort, you may contact one of the following or any reputable counselling centre near you. Please note that CPCS only sees clients by appointment.</p>
                    
                    <p style="margin-top: 15px;"><strong>Centre of Psychological and Counselling Services (CPCS)</strong><br>
                    Website: <a href="https://www.cpcs-helpuni.com/" target="_blank">https://www.cpcs-helpuni.com/</a><br>
                    Phone: +603 2096 1212 / +603 7849 3200<br>
                    Email: cpcs@help.edu.my</p>

                    <p><strong>Befrienders KL</strong><br>
                    Website: <a href="https://www.befrienders.org.my/" target="_blank">https://www.befrienders.org.my/</a><br>
                    Phone: +603 7627 2929<br>
                    Email: sam@befrienders.org.my</p>
                </div>

                <h3>Benefits of this study</h3>
                <p>There will not be any direct benefit to you in participating in this study, but you will help the researcher to learn more about the relationship between intolerance of uncertainty and indecisiveness among university students in Malaysia.</p>

                <h3>Confidentiality:</h3>
                <p>Your participation in this study will remain completely confidential. No identifying information will be collected and your responses will be recorded anonymously. Only the research team and their academic supervisor will have access to the data, which will be used solely for research purposes. Every effort will be made to ensure your privacy is protected throughout the study.</p>

                <h3>Decision to quit at anytime:</h3>
                <p>Participation in this study is completely voluntary. If you choose to participate, you can withdraw at any time by simply exiting the Google Form without submitting it. There will be no consequences for choosing to withdraw from the study.</p>

                <h3>Rights and complaints:</h3>
                <p>This study has been reviewed and approved by the Ethics Review Board, Department of Psychology, Faculty of Behavioral Sciences, Education, and Languages at HELP University [ERB Approval Code: N/A]. For any research-related problems or questions regarding participants' rights, please contact the Chairperson of the Ethics Review Board.</p>

                <div class="info-box">
                    <p><strong>Chairperson, Ethics Review Board</strong><br>
                    Department of Psychology, Faculty of Behavioural Sciences<br>
                    Level 3, Block B HELP University ‚Äì Subang 2<br>
                    Persiaran Cakerawala, Seksyen U4, 40150 Shah Alam<br>
                    Selangor Darul Ehsan<br>
                    Malaysia<br>
                    Email: psych.erb@help.edu.my<br>
                    Phone: +603 7849 3000</p>
                </div>

                <p>For any enquiries of this study, please feel free to contact the researcher via the email addresses as stated below:</p>
                
                <p><strong>Researcher's supervisor:</strong><br>
                Ms. Khor Khai Ling<br>
                khailing.k@help.edu.my</p>

                <p><strong>Researcher:</strong><br>
                Pang Jia Hui<br>
                B2300221@helplive.edu.my</p>

                <h3>Consent Statement:</h3>
                <p>I have read and understand the explanation provided to me, and I voluntarily agree to participate in this study.</p>

                <div class="form-group">
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="consent" value="agree">
                            Agree
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="consent" value="disagree">
                            Disagree
                        </label>
                    </div>
                    <div class="error" id="consentError">Please select an option to continue.</div>
                </div>

                <div class="button-group">
                    <button class="btn-primary" onclick="nextSection(1)">Continue</button>
                </div>
            </div>

            <!-- Demographics -->
            <div id="section2" class="section">
                <h2>Demographic Form</h2>
                <p>All information obtained will be fully confidential and will only be used for the purpose of this study.</p>

                <div class="form-group">
                    <label>Age:</label>
                    <input type="number" id="age" min="18" max="30" placeholder="Enter your age">
                    <div class="error" id="ageError">Please enter a valid age (18-30).</div>
                </div>

                <div class="form-group">
                    <label>Gender:</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="gender" value="male">
                            Male
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gender" value="female">
                            Female
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="gender" value="prefer-not">
                            Prefer not to say
                        </label>
                    </div>
                    <div class="error" id="genderError">Please select your gender.</div>
                </div>

                <div class="form-group">
                    <label>Field of Study:</label>
                    <select id="fieldOfStudy">
                        <option value="">-- Select --</option>
                        <option value="arts">Arts, Humanities & Social Sciences</option>
                        <option value="business">Business, Accounting & Management</option>
                        <option value="stem">Science, Technology & Engineering (STEM)</option>
                        <option value="health">Medicine, Health Sciences & Nursing</option>
                        <option value="other">Other</option>
                    </select>
                    <input type="text" id="fieldOther" placeholder="Please specify" style="margin-top: 10px; display: none;">
                    <div class="error" id="fieldError">Please select your field of study.</div>
                </div>

                <div class="form-group">
                    <label>Level of Education:</label>
                    <select id="education">
                        <option value="">-- Select --</option>
                        <option value="foundation">Foundation</option>
                        <option value="bachelor">Bachelor's Degree</option>
                        <option value="master">Master's Degree</option>
                        <option value="phd">PhD</option>
                    </select>
                    <div class="error" id="educationError">Please select your level of education.</div>
                </div>

                <div class="form-group">
                    <label>Nationality:</label>
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="nationality" value="malaysian">
                            Malaysian
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="nationality" value="other">
                            Other
                            <input type="text" id="nationalityOther" placeholder="Please specify" style="margin-left: 10px; width: 200px;">
                        </label>
                    </div>
                    <div class="error" id="nationalityError">Please select your nationality.</div>
                </div>

                <div class="button-group">
                    <button class="btn-secondary" onclick="prevSection(2)">Back</button>
                    <button class="btn-primary" onclick="nextSection(2)">Continue</button>
                </div>
            </div>

            <!-- IUS-12 -->
            <div id="section3" class="section">
                <h2>Intolerance of Uncertainty Scale (IUS-12; Carleton et al., 2007)</h2>
                
                <p>The Intolerance of Uncertainty Scale consists of 12 items that measure how you react to uncertain or unpredictable situations. Indicate how much each statement describes you.</p>

                <div class="info-box">
                    <p><strong>1</strong> - Not at all characteristic of me<br>
                    <strong>2</strong> - A little characteristic of me<br>
                    <strong>3</strong> - Somewhat characteristic of me<br>
                    <strong>4</strong> - Very characteristic of me<br>
                    <strong>5</strong> - Entirely characteristic of me</p>
                    <p style="margin-top: 10px;"><strong>Please answer as honestly as possible, there are no right or wrong answers.</strong></p>
                </div>

                <div id="iusQuestions"></div>

                <div class="button-group">
                    <button class="btn-secondary" onclick="prevSection(3)">Back</button>
                    <button class="btn-primary" onclick="nextSection(3)">Continue</button>
                </div>
            </div>

            <!-- Information Sampling Task -->
            <div id="section4" class="section">
                <h2>Information Sampling Task</h2>

                <div class="trial-indicator">
                    Trial <span id="currentTrial">1</span> of 20 | <span id="conditionLabel" style="color: #764ba2;">Condition: Fixed Win</span>
                </div>

                <div style="text-align: center; margin-bottom: 20px;">
                    <div style="display: inline-block; background: #f8f9fa; padding: 15px 30px; border-radius: 8px; border: 2px solid #667eea;">
                        <div style="font-size: 14px; color: #666; margin-bottom: 5px;">Current Points Available</div>
                        <div style="font-size: 32px; font-weight: bold; color: #667eea;" id="currentPoints">100</div>
                    </div>
                    <div style="display: inline-block; background: #f8f9fa; padding: 15px 30px; border-radius: 8px; border: 2px solid #28a745; margin-left: 20px;">
                        <div style="font-size: 14px; color: #666; margin-bottom: 5px;">Total Score</div>
                        <div style="font-size: 32px; font-weight: bold; color: #28a745;" id="totalScore">0</div>
                    </div>
                </div>

                <div class="info-box">
                    <h3>Instructions</h3>
                    <p>Your task is to decide which color appears more frequently in a 5x5 grid. Click on the grey boxes to reveal their colors (red or blue). You can reveal as many or as few boxes as you want before making your decision.</p>
                    <p style="margin-top: 10px;"><strong>Points System:</strong></p>
                    <ul style="margin-left: 20px;">
                        <li><strong>Fixed Win trials:</strong> Correct decisions earn 100 points, regardless of boxes opened</li>
                        <li><strong>Decreasing Win trials:</strong> Start with 100 points, lose 10 points for each box opened</li>
                    </ul>
                    <p style="margin-top: 10px;"><strong>There is no time limit. Take as long as you need.</strong></p>
                </div>

                <div class="ist-container">
                    <div class="ist-counter">
                        Boxes Revealed: <span id="revealCount">0</span> / 25
                    </div>

                    <div id="istGrid" class="ist-grid"></div>

                    <div class="ist-buttons">
                        <button class="ist-btn ist-btn-red" onclick="makeDecision('red')" id="redBtn">
                            Red is More Common
                        </button>
                        <button class="ist-btn ist-btn-blue" onclick="makeDecision('blue')" id="blueBtn">
                            Blue is More Common
                        </button>
                    </div>

                    <div id="resultMessage"></div>
                </div>

                <div class="button-group" style="border-top: none; padding-top: 0;">
                    <button class="btn-primary" id="nextTrialBtn" style="display: none;" onclick="nextTrial()">Next Trial</button>
                    <button class="btn-primary" id="continueToEndBtn" style="display: none;" onclick="nextSection(4)">Continue</button>
                </div>
            </div>

            <!-- Thank You -->
            <div id="section5" class="section">
                <div style="text-align: center; padding: 20px 0;">
                    <div class="icon-circle" style="width: 80px; height: 80px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin: 0 auto 20px; animation: scaleIn 0.5s ease-out;">
                        <div style="color: white; font-size: 40px; font-weight: bold;">‚úì</div>
                    </div>
                    <h1 style="color: #2d3748; font-size: 32px; margin-bottom: 15px;">Thank You for Contributing to This Study!</h1>
                    <p style="color: #4a5568; font-size: 16px; line-height: 1.6; margin-bottom: 30px;">
                        Thank you for taking the time to complete this survey. Your responses are greatly appreciated 
                        and will contribute to a better understanding of how intolerance of uncertainty relates to 
                        indecisiveness in a university student population.
                    </p>
                </div>

                <div style="background: #f7fafc; border-radius: 12px; padding: 25px; margin-bottom: 25px;">
                    <h2 style="color: #2d3748; font-size: 20px; margin-bottom: 20px; display: flex; align-items: center; gap: 10px;">
                        üéØ Why Your Participation Matters
                    </h2>
                    
                    <div class="impact-item" style="display: flex; align-items: flex-start; margin-bottom: 15px; padding: 12px; background: white; border-radius: 8px;">
                        <div style="font-size: 24px; margin-right: 12px;">‚ú®</div>
                        <div style="color: #4a5568; font-size: 15px; line-height: 1.5;">
                            <strong style="color: #2d3748; font-weight: 600;">Advancing Knowledge</strong> ‚Äì Your participation provides empirical evidence 
                            linking cognitive-emotional factors to decision-making behavior
                        </div>
                    </div>

                    <div class="impact-item" style="display: flex; align-items: flex-start; margin-bottom: 15px; padding: 12px; background: white; border-radius: 8px;">
                        <div style="font-size: 24px; margin-right: 12px;">üß©</div>
                        <div style="color: #4a5568; font-size: 15px; line-height: 1.5;">
                            <strong style="color: #2d3748; font-weight: 600;">Refining Psychological Models</strong> ‚Äì Your data can help refine existing 
                            psychological models of decision-making
                        </div>
                    </div>

                    <div class="impact-item" style="display: flex; align-items: flex-start; margin-bottom: 0; padding: 12px; background: white; border-radius: 8px;">
                        <div style="font-size: 24px; margin-right: 12px;">üî¨</div>
                        <div style="color: #4a5568; font-size: 15px; line-height: 1.5;">
                            <strong style="color: #2d3748; font-weight: 600;">Multi-Method Approach</strong> ‚Äì By combining self-report measures with a 
                            behavioral task, you're contributing to a more comprehensive approach to studying indecisiveness
                        </div>
                    </div>
                </div>

                <div style="background: #edf2f7; border-left: 4px solid #667eea; padding: 20px; border-radius: 8px; margin-bottom: 30px;">
                    <h3 style="color: #2d3748; font-size: 18px; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                        üîí Your Privacy is Protected
                    </h3>
                    <p style="color: #4a5568; font-size: 15px; line-height: 1.6;">
                        Everything you've shared will remain <strong>completely confidential</strong> and used only 
                        for academic research purposes.
                    </p>
                </div>

                <div style="text-align: center; color: #4a5568; font-size: 16px; line-height: 1.6; margin-bottom: 30px;">
                    <strong>Thank you again for your time and support ‚Äî your participation truly makes a difference!</strong> 
                    <span style="font-size: 24px; display: inline-block;">üåº</span>
                </div>

                <div class="button-group" style="justify-content: center; border-top: none;">
                    <button class="btn-success" onclick="submitData()" style="width: 100%; max-width: 400px; padding: 16px; font-size: 18px;">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // IUS-12 Questions (exact from PDF)
        const iusQuestions = [
            "Unforeseen events upset me greatly.",
            "It frustrates me not having all the information I need.",
            "Uncertainty keeps me from living a full life.",
            "One should always look ahead so as to avoid surprises.",
            "A small unforeseen event can spoil everything, even with the best of planning.",
            "When it's time to act, uncertainty paralyses me.",
            "When I am uncertain I can't function very well.",
            "I always want to know what the future has in store for me.",
            "I can't stand being taken by surprise.",
            "The smallest doubt can stop me from acting.",
            "I should be able to organize everything in advance.",
            "I must get away from all uncertain situations."
        ];

        let currentSection = 1;
        const totalSections = 5;

        let formData = {
            participantID: null,
            timestamp: null,
            consent: null,
            demographics: {},
            iusResponses: {},
            istTrials: []
        };

        // IST variables
        let currentTrial = 1;
        const totalTrials = 20; // 10 Fixed Win + 10 Decreasing Win
        let currentCondition = 'Fixed Win'; // 'Fixed Win' or 'Decreasing Win'
        let grid = [];
        let majorityColor = '';
        let revealedBoxes = 0;
        let currentPoints = 100;
        let totalScore = 0;
        
        // Points system
        const FIXED_WIN_POINTS = 100; // Always 100 points in FW condition
        const DECREASING_WIN_START = 100; // Start at 100 points in DW condition
        const POINTS_PER_BOX = 10; // Lose 10 points per box opened in DW condition
        
        // 60% majority for all trials
        const MAJORITY_PERCENTAGE = 0.60;

        // Initialize
        window.onload = function() {
            formData.participantID = 'P' + Date.now() + '-' + Math.floor(Math.random() * 10000);
            formData.timestamp = new Date().toISOString();
            initIUSQuestions();
            updateProgress();
        };

        function initIUSQuestions() {
            const container = document.getElementById('iusQuestions');
            iusQuestions.forEach((question, index) => {
                const questionDiv = document.createElement('div');
                questionDiv.className = 'form-group';
                questionDiv.style.borderBottom = '1px solid #e0e0e0';
                questionDiv.style.paddingBottom = '25px';
                questionDiv.style.marginBottom = '25px';
                
                questionDiv.innerHTML = `
                    <label style="margin-bottom: 15px;">${question}</label>
                    <div class="number-scale" id="scale${index}">
                        ${[1, 2, 3, 4, 5].map(num => `
                            <div class="number-box" onclick="selectNumber(${index}, ${num})" data-value="${num}">
                                ${num}
                            </div>
                        `).join('')}
                    </div>
                    <div class="scale-labels">
                        <span>Not at all characteristic of me</span>
                        <span>Entirely characteristic of me</span>
                    </div>
                `;
                container.appendChild(questionDiv);
            });
        }

        function selectNumber(questionIndex, value) {
            // Remove previous selection
            const scale = document.getElementById('scale' + questionIndex);
            scale.querySelectorAll('.number-box').forEach(box => {
                box.classList.remove('selected');
            });
            
            // Add selection to clicked box
            const boxes = scale.querySelectorAll('.number-box');
            boxes[value - 1].classList.add('selected');
            
            // Store response
            formData.iusResponses['q' + (questionIndex + 1)] = value;
        }

        function updateProgress() {
            const progress = ((currentSection - 1) / totalSections) * 100;
            document.getElementById('progressFill').style.width = progress + '%';
        }

        function nextSection(section) {
            if (!validateSection(section)) {
                return;
            }

            saveData(section);

            // Check for disagree on consent
            if (section === 1) {
                const consent = document.querySelector('input[name="consent"]:checked');
                if (consent && consent.value === 'disagree') {
                    alert('Thank you for your time. Since you did not consent, the study will end here.');
                    window.close();
                    return;
                }
            }

            // Initialize IST on section 4
            if (section === 3) {
                initIST();
            }

            document.getElementById('section' + section).classList.remove('active');
            currentSection = section + 1;
            document.getElementById('section' + currentSection).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }

        function prevSection(section) {
            document.getElementById('section' + section).classList.remove('active');
            currentSection = section - 1;
            document.getElementById('section' + currentSection).classList.add('active');
            updateProgress();
            window.scrollTo(0, 0);
        }

        function validateSection(section) {
            document.querySelectorAll('.error').forEach(e => e.style.display = 'none');

            if (section === 1) {
                if (!document.querySelector('input[name="consent"]:checked')) {
                    document.getElementById('consentError').style.display = 'block';
                    return false;
                }
            }

            if (section === 2) {
                let valid = true;
                const age = document.getElementById('age').value;
                if (!age || age < 18 || age > 30) {
                    document.getElementById('ageError').style.display = 'block';
                    valid = false;
                }
                if (!document.querySelector('input[name="gender"]:checked')) {
                    document.getElementById('genderError').style.display = 'block';
                    valid = false;
                }
                if (!document.getElementById('fieldOfStudy').value) {
                    document.getElementById('fieldError').style.display = 'block';
                    valid = false;
                }
                if (!document.getElementById('education').value) {
                    document.getElementById('educationError').style.display = 'block';
                    valid = false;
                }
                if (!document.querySelector('input[name="nationality"]:checked')) {
                    document.getElementById('nationalityError').style.display = 'block';
                    valid = false;
                }
                return valid;
            }

            if (section === 3) {
                for (let i = 0; i < iusQuestions.length; i++) {
                    if (!formData.iusResponses['q' + (i + 1)]) {
                        alert('Please answer all questions before continuing.');
                        return false;
                    }
                }
            }

            return true;
        }

        function saveData(section) {
            if (section === 1) {
                formData.consent = document.querySelector('input[name="consent"]:checked').value;
            }

            if (section === 2) {
                formData.demographics = {
                    age: document.getElementById('age').value,
                    gender: document.querySelector('input[name="gender"]:checked').value,
                    fieldOfStudy: document.getElementById('fieldOfStudy').value,
                    fieldOther: document.getElementById('fieldOther').value,
                    education: document.getElementById('education').value,
                    nationality: document.querySelector('input[name="nationality"]:checked').value,
                    nationalityOther: document.getElementById('nationalityOther').value
                };
            }
        }

        // IST Functions
        function initIST() {
            const gridSize = 5;
            const maxBoxes = gridSize * gridSize;
            
            // Determine condition (Trials 1-10: Fixed Win, Trials 11-20: Decreasing Win)
            if (currentTrial <= 10) {
                currentCondition = 'Fixed Win';
                currentPoints = FIXED_WIN_POINTS;
                document.getElementById('conditionLabel').textContent = 'Condition: Fixed Win (100 pts)';
            } else {
                currentCondition = 'Decreasing Win';
                currentPoints = DECREASING_WIN_START;
                document.getElementById('conditionLabel').textContent = 'Condition: Decreasing Win (100 pts - 10 pts/box)';
            }
            
            // Create grid with 60% majority
            grid = [];
            majorityColor = Math.random() > 0.5 ? 'red' : 'blue';
            const majorityCount = Math.round(maxBoxes * MAJORITY_PERCENTAGE);
            
            for (let i = 0; i < majorityCount; i++) {
                grid.push(majorityColor);
            }
            for (let i = majorityCount; i < maxBoxes; i++) {
                grid.push(majorityColor === 'red' ? 'blue' : 'red');
            }
            
            // Shuffle grid
            grid.sort(() => Math.random() - 0.5);
            
            // Render grid
            const gridContainer = document.getElementById('istGrid');
            gridContainer.innerHTML = '';
            
            for (let i = 0; i < maxBoxes; i++) {
                const box = document.createElement('div');
                box.className = 'ist-box';
                box.id = 'box' + i;
                box.textContent = '?';
                box.setAttribute('data-color', grid[i]);
                box.onclick = () => revealBox(i);
                gridContainer.appendChild(box);
            }
            
            // Reset counters
            revealedBoxes = 0;
            document.getElementById('revealCount').textContent = '0';
            document.getElementById('currentTrial').textContent = currentTrial;
            document.getElementById('currentPoints').textContent = currentPoints;
            document.getElementById('totalScore').textContent = totalScore;
            document.getElementById('resultMessage').innerHTML = '';
            document.getElementById('redBtn').disabled = false;
            document.getElementById('blueBtn').disabled = false;
            document.getElementById('nextTrialBtn').style.display = 'none';
            document.getElementById('continueToEndBtn').style.display = 'none';
        }

        function revealBox(index) {
            const box = document.getElementById('box' + index);
            if (box.classList.contains('revealed')) return;
            
            const color = box.getAttribute('data-color');
            box.style.background = color === 'red' ? '#e74c3c' : '#3498db';
            box.textContent = '';
            box.classList.add('revealed');
            
            revealedBoxes++;
            document.getElementById('revealCount').textContent = revealedBoxes;
            
            // Update points for Decreasing Win condition
            if (currentCondition === 'Decreasing Win') {
                currentPoints = Math.max(0, DECREASING_WIN_START - (revealedBoxes * POINTS_PER_BOX));
                document.getElementById('currentPoints').textContent = currentPoints;
                
                // Add visual feedback for point decrease
                const pointsDisplay = document.getElementById('currentPoints');
                pointsDisplay.style.color = '#dc3545';
                setTimeout(() => {
                    pointsDisplay.style.color = '#667eea';
                }, 300);
            }
        }

        function makeDecision(choice) {
            // Count actual colors in grid
            let redTotal = grid.filter(c => c === 'red').length;
            let blueTotal = grid.filter(c => c === 'blue').length;
            
            // Determine if correct
            const correct = choice === majorityColor;
            
            // Award points only if correct
            let pointsEarned = 0;
            if (correct) {
                if (currentCondition === 'Fixed Win') {
                    pointsEarned = FIXED_WIN_POINTS;
                } else { // Decreasing Win
                    pointsEarned = currentPoints;
                }
                totalScore += pointsEarned;
            }
            
            // Record trial data
            formData.istTrials.push({
                trial: currentTrial,
                condition: currentCondition,
                boxesRevealed: revealedBoxes,
                decision: choice,
                correctAnswer: majorityColor,
                correct: correct,
                redTotal: redTotal,
                blueTotal: blueTotal,
                pointsAvailable: currentPoints,
                pointsEarned: pointsEarned,
                totalScore: totalScore
            });

            // Reveal all boxes
            for (let i = 0; i < 25; i++) {
                const box = document.getElementById('box' + i);
                if (!box.classList.contains('revealed')) {
                    const color = box.getAttribute('data-color');
                    box.style.background = color === 'red' ? '#e74c3c' : '#3498db';
                    box.textContent = '';
                    box.classList.add('revealed');
                }
            }

            // Show result with points
            const resultDiv = document.getElementById('resultMessage');
            if (correct) {
                resultDiv.className = 'result-message correct';
                resultDiv.innerHTML = `‚úÖ <strong>Correct!</strong> The majority color was ${majorityColor.toUpperCase()}.<br>
                                      (Red: ${redTotal}, Blue: ${blueTotal})<br>
                                      <strong style="font-size: 20px; color: #28a745;">+${pointsEarned} points!</strong>`;
            } else {
                resultDiv.className = 'result-message incorrect';
                resultDiv.innerHTML = `‚ùå <strong>Incorrect.</strong> The majority color was ${majorityColor.toUpperCase()}, not ${choice.toUpperCase()}.<br>
                                      (Red: ${redTotal}, Blue: ${blueTotal})<br>
                                      <strong style="color: #dc3545;">+0 points</strong>`;
            }

            // Update total score display
            document.getElementById('totalScore').textContent = totalScore;

            // Disable decision buttons
            document.getElementById('redBtn').disabled = true;
            document.getElementById('blueBtn').disabled = true;

            // Show next button
            if (currentTrial < totalTrials) {
                document.getElementById('nextTrialBtn').style.display = 'block';
            } else {
                document.getElementById('continueToEndBtn').style.display = 'block';
            }
        }

        function nextTrial() {
            currentTrial++;
            initIST();
        }

        function submitData() {
            // Calculate IUS total
            let iusTotal = 0;
            for (let key in formData.iusResponses) {
                iusTotal += formData.iusResponses[key];
            }
            formData.iusTotal = iusTotal;

            // Show loading message
            const submitBtn = document.querySelector('.btn-success');
            submitBtn.disabled = true;
            submitBtn.textContent = 'Submitting...';

            // REPLACE THIS URL WITH YOUR GOOGLE APPS SCRIPT WEB APP URL
            const GOOGLE_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbymBrb1ISC5w-4lYKEkz38emtMDBBcT85Vo9oGKj3bKCS8ia7mDey1C4RI0-PrFpC0KGw/exec';

            // Send data to Google Sheets
            fetch(GOOGLE_SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(formData)
            })
            .then(() => {
                // Success - data sent
                submitBtn.textContent = 'Submitted Successfully! ‚úì';
                submitBtn.style.background = '#28a745';
                alert('Thank you! Your responses have been submitted successfully.\n\nYou may now close this window.');
                
                // Optional: Also download a backup copy for participant
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(formData, null, 2));
                const downloadAnchor = document.createElement('a');
                downloadAnchor.setAttribute("href", dataStr);
                downloadAnchor.setAttribute("download", `study_data_${formData.participantID}.json`);
                document.body.appendChild(downloadAnchor);
                downloadAnchor.click();
                downloadAnchor.remove();
            })
            .catch((error) => {
                // Error - fallback to download
                console.error('Error:', error);
                submitBtn.disabled = false;
                submitBtn.textContent = 'Submit';
                alert('There was an error submitting your data online.\n\nYour data will be downloaded to your computer instead.\n\nPlease email the downloaded file to: B2300221@helplive.edu.my');
                
                // Download as backup
                const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(formData, null, 2));
                const downloadAnchor = document.createElement('a');
                downloadAnchor.setAttribute("href", dataStr);
                downloadAnchor.setAttribute("download", `study_data_${formData.participantID}.json`);
                document.body.appendChild(downloadAnchor);
                downloadAnchor.click();
                downloadAnchor.remove();
            });
        }

        // Show/hide other fields
        document.getElementById('fieldOfStudy').addEventListener('change', function() {
            document.getElementById('fieldOther').style.display = this.value === 'other' ? 'block' : 'none';
        });
    </script>
</body>
</html>
